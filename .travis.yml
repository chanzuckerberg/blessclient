language: go
go:
- '1.11'
install:
  - npm install -g snyk
  - apt install -yq libusb-dev libusb-1.0.0-dev
  - make setup
jobs:
  include:
    - stage: check
      script:
        - make test
        - bash <(curl -s https://codecov.io/bash)
    - stage: check
      script:
        - bash _bin/snyk.sh
    - stage: check
      script:
        - make lint

